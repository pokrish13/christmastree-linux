#!/bin/bash

# For one-line install: skip executable check when running via pipe
if [[ ! -t 0 ]]; then
    # Running via pipe (curl | bash), download and make executable
    SCRIPT_NAME="Christmastree"
    if [ ! -f "$SCRIPT_NAME" ]; then
        echo "ðŸ“¥ Downloading Christmastree..."
        curl -sL https://raw.githubusercontent.com/pokrish13/christmastree-linux/main/Christmastree -o "$SCRIPT_NAME"
        chmod +x "$SCRIPT_NAME"
        echo "âœ… Downloaded! Run: ./Christmastree"
        exit 0
    fi
fi

# Normal executable check for direct runs
if [ ! -x "$0" ] && [ -f "$0" ]; then
    echo "Making Christmastree executable..."
    chmod +x "$0"
    echo "âœ… Now you can run: ./Christmastree"
    exit 0
fi

GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PINK='\033[0;35m'
CYAN='\033[0;36m'
WHITE='\033[1;37m'
NC='\033[0m'

colors=($RED $YELLOW $BLUE $PINK $CYAN $WHITE)

draw_tree() {
    printf "\033[2J\033[H"
    rand_color=${colors[$RANDOM % ${#colors[@]}]}
    
    echo -e "${YELLOW}         â˜†${NC}"
    echo -e "${GREEN}        * *${NC}"
    echo -e "       ${GREEN}* ${rand_color}Â°${GREEN} * ${rand_color}Â°${GREEN}"
    echo -e "      * * * *"
    echo -e "     * ${rand_color}Â°${GREEN} * ${rand_color}Â°${GREEN} * ${GREEN}"
    echo -e "    * * * * * *"
    echo -e "   * ${rand_color}Â°${GREEN} * ${rand_color}Â°${GREEN} * ${rand_color}Â°${GREEN} * ${GREEN}"
    echo -e "  * * * * * * * *"
    echo -e " * ${rand_color}Â°${GREEN} * ${rand_color}Â°${GREEN} * ${rand_color}Â°${GREEN} * ${rand_color}Â°${GREEN} * ${GREEN}"
    echo -e "* * * * * * * * * *"
    echo -e "${YELLOW}        | |"
    echo -e "        | |${NC}"
    echo -e "${RED}   ðŸŽ„ Merry Christmas! ðŸŽ„${NC}"
    echo -e "${RED}   ðŸŽ‰ Happy New Year! ðŸŽ‰${NC}"
}

echo -e "${GREEN}ðŸŽ„ Starting Christmas Tree...${NC}"
sleep 1

while true; do
    draw_tree
    sleep 0.5
done
